extends ../layout.pug
//- views/project/form.pug
block content
  .d-flex.justify-content-center
    form.bg-dark.text-white.p-4.rounded.shadow(action="/projects", method="POST", style="width:100%; max-width:1200px; max-height:100vh; overflow-y:auto;")
      .d-flex.justify-content-between.align-items-center.mb-3
        h1.mb-0 Crear Nuevo Proyecto
        a.btn.btn-gray(href="/projects") Volver a la lista

      // Contenedor de 2 columnas
      .row.g-3
        // Columna izquierda
        .col-md-6
          .mb-3
            label.form-label(for="name") Nombre de Proyecto
            input#name.form-control(type="text", name="name", value=item.name || "", required)
          .mb-3
            label.form-label(for="description") Descripción
            textarea#description.form-control(name="description", required)= item.description || ""
          .mb-3
            label.form-label(for="start_date") Fecha de inicio
            input#start_date.form-control(type="date", name="start_date", value=item.start_date || "")
          .mb-3
            label.form-label(for="client_id") Cliente
            select#client_id.form-select(name="client_id", required)
              if clients && clients.length > 0
                each client in clients
                  option(
                    value=client._id 
                    selected=(item.client_id && client._id.toString() === item.client_id._id.toString())
                  ) #{client.name}
              else
                option(value="") No hay clientes disponibles

        // Columna derecha
        .col-md-6
          .mb-3
            label.form-label(for="end_date") Fecha de fin
            input#end_date.form-control(type="date", name="end_date", value=item.end_date || "")
          .mb-3
            label.form-label(for="budget") Presupuesto
            input#budget.form-control(type="number", name="budget", value=item.budget || "")
          .mb-3
            label.form-label(for="billing_type") Tipo de facturación
            select#billing_type.form-select(name="billing_type", required)
              option(value="hourly" selected=(item.billing_type === "hourly")) Por horas
              option(value="fixed" selected=(item.billing_type === "fixed")) Precio fijo
          .mb-3
            label.form-label(for="status") Estado
            select#status.form-select(name="status", required)
              option(value="pending" selected=(item.status === "pending")) Pendiente
              option(value="in_progress" selected=(item.status === "in_progress")) En progreso
              option(value="completed" selected=(item.status === "completed")) Completado
          .mb-3
            label.form-label(for="manager_id") Manager
            select#manager_id.form-select(name="manager_user_id", required)
              if managers && managers.length > 0
                each manager in managers
                  option(
                    value=manager._id 
                    selected=(item.manager_user_id && manager._id.toString() === item.manager_user_id._id.toString())
                  ) #{manager.first_name + ' ' + manager.last_name}
              else
                option(value="") No hay managers disponibles


      button.btn.btn-primary.mt-3(type="submit") Crear Proyecto
