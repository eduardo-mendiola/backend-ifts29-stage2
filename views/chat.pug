extends layout

block content
  .container-fluid.h-100.p-0
    .row.h-100.g-0
      //- Contacts Panel
      .col-md-4.col-lg-3.contacts-panel
        .p-3.border-bottom.d-flex.justify-content-between.align-items-center
          h5.mb-0.text-themed Chat Interno
          button#newChatBtn.btn.btn-sm.btn-primary(type="button" title="Nuevo Chat")
            i.bi.bi-plus-lg
        .contacts-list#contactsList
          //- Conversations will be loaded dynamically

      //- Conversation Panel
      .col-md-8.col-lg-9.conversation-panel
        //- Header
        .conversation-header.p-3.border-bottom#conversationHeader(style="display: none;")
          .d-flex.align-items-center.justify-content-between
            .d-flex.align-items-center
              .avatar.me-3
                i.bi.bi-person-circle.fs-3.text-themed
              .flex-grow-1
                h6.mb-0.text-themed#current-contact-name
                small.text-muted#current-contact-status En línea
            button#deleteConversationBtn.btn.btn-sm.btn-outline-danger(type="button" title="Eliminar conversación")
              i.bi.bi-trash
        
        //- Empty state
        .empty-state.d-flex.flex-column.align-items-center.justify-content-center.h-100#emptyState
          i.bi.bi-chat-dots.fs-1.text-muted.mb-3
          p.text-muted Selecciona una conversación o inicia un nuevo chat
        
        //- Messages Area
        .messages-container#messagesContainer(style="display: none;")
          ul#messages.list-unstyled.p-3
            //- Messages will be dynamically added here
        
        //- Input Area
        .input-area.p-3.border-top#inputArea(style="display: none;")
          form#chatForm.d-flex.gap-2
            input#messageInput.form-control(type="text" placeholder="Escribe un mensaje..." autocomplete="off")
            button.btn.btn-primary(type="submit")
              i.bi.bi-send

  //- Contact Selection Modal
  .modal.fade#contactModal(tabindex="-1")
    .modal-dialog.modal-dialog-centered
      .modal-content
        .modal-header
          h5.modal-title Nuevo Chat
          button.btn-close(type="button" data-bs-dismiss="modal")
        .modal-body
          input#contactSearch.form-control.mb-3(type="text" placeholder="Buscar contacto...")
          #contactList.list-group
            //- Contacts will be loaded here

  //- User data for JavaScript
  script.
    window.user = {
      _id: '#{user._id}',
      username: '#{user.username}',
      email: '#{user.email || ""}'
    };

  //- Socket.io client
  script(src="/socket.io/socket.io.js")
  script(src="/js/chat.js")
